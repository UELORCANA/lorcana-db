<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TCG カードDB（非公式）</title>

<style>
body {
  font-family: system-ui, sans-serif;
  background:#f5f5f5;
  margin:0;
  padding:12px;
}

h1 { text-align:center; font-size:1.4rem; }

.disclaimer {
  font-size:0.75rem;
  background:#fff;
  padding:8px;
  border-radius:6px;
  margin-bottom:12px;
}

.search-box {
  background:#fff;
  padding:12px;
  border-radius:8px;
  margin-bottom:16px;
}

label { font-size:0.85rem; display:block; margin-top:8px; }

input, select {
  width:100%;
  padding:6px;
  margin-top:4px;
}

.range { display:flex; gap:6px; }

.card-list {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:12px;
}

.card {
  background:#fff;
  padding:8px;
  border-radius:8px;
  cursor:pointer;
}

.card-image {
  width:100%;
  aspect-ratio:63/88;
  background:#000;
}

.card-image img {
  width:100%;
  height:100%;
  object-fit:contain;
}

.card-name {
  text-align:center;
  font-size:0.9rem;
  font-weight:bold;
  margin-top:6px;
}

/* モーダル */
.modal {
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  justify-content:center;
  align-items:center;
}
.modal-content {
  background:#fff;
  padding:12px;
  max-width:90%;
  border-radius:8px;
}
.modal-content img { width:100%; }
.close { text-align:right; cursor:pointer; }
</style>
</head>

<body>

<h1>TCG カードDB（非公式）</h1>

<div class="disclaimer">
本サイトは非公式のファンサイトです。<br>
Disney Lorcana に関する権利は各権利者に帰属します。
</div>

<div class="search-box">
  <label>フリーワード</label>
  <input id="kw">

  <label>コスト</label>
  <div class="range">
    <input id="costMin" type="number" placeholder="最小">
    <input id="costMax" type="number" placeholder="最大">
  </div>

  <label>攻撃力</label>
  <div class="range">
    <select id="atkMin"></select>
    <select id="atkMax"></select>
  </div>

  <label>意思力</label>
  <div class="range">
    <select id="willMin"></select>
    <select id="willMax"></select>
  </div>

  <label>ロア</label>
  <select id="lore"></select>

  <label>色</label>
  <select id="color">
    <option value="">指定なし</option>
    <option>アンバー</option>
  </select>

  <label>レアリティ</label>
  <select id="rarity">
    <option value="">指定なし</option>
    <option>レア</option>
  </select>

  <label>セット</label>
  <select id="set"></select>

  <label>種族</label>
  <label><input type="checkbox" value="ストーリーボーン" class="race"> ストーリーボーン</label>
  <label><input type="checkbox" value="ヒーロー" class="race"> ヒーロー</label>

  <button onclick="search()">検索</button>
</div>

<div class="card-list" id="list"></div>

<div class="modal" id="modal" onclick="closeModal()">
  <div class="modal-content" onclick="event.stopPropagation()">
    <div class="close" onclick="closeModal()">×</div>
    <img id="modalImg">
    <p id="modalText"></p>
  </div>
</div>

<script>
const cards=[{
  name:"LADY Family Dog",
  image:"lady_familydog.webp",
  cost:3, atk:2, will:2, lore:2,
  color:"アンバー", rarity:"レア", set:8,
  race:["ストーリーボーン","ヒーロー"],
  text:"このキャラクターをプレイしたとき、コスト2以下のキャラクターを1体コストを支払わずにプレイしてもよい。"
}];

function fill(id,max){
  const s=document.getElementById(id);
  s.innerHTML='<option value="">指定なし</option>';
  for(let i=0;i<=max;i++) s.innerHTML+=`<option>${i}</option>`;
}
fill("atkMin",12); fill("atkMax",12);
fill("willMin",12); fill("willMax",12);
fill("lore",5); fill("set",8);

function search(){
  const kw = document.getElementById("kw").value.toLowerCase();

  const costMin = Number(document.getElementById("costMin")?.value);
  const costMax = Number(document.getElementById("costMax")?.value);

  const atkMin = Number(document.getElementById("atkMin").value);
  const atkMax = Number(document.getElementById("atkMax").value);

  const willMin = Number(document.getElementById("willMin").value);
  const willMax = Number(document.getElementById("willMax").value);

  const lore = document.getElementById("lore").value;
  const color = document.getElementById("color").value;
  const rarity = document.getElementById("rarity").value;
  const set = document.getElementById("set").value;

  const races = [...document.querySelectorAll(".race:checked")]
                  .map(r => r.value);

  const result = cards.filter(c => {

    // フリーワード
    if (kw && !(`${c.name}${c.text}`.toLowerCase().includes(kw))) return false;

    // コスト
    if (!isNaN(costMin) && c.cost < costMin) return false;
    if (!isNaN(costMax) && c.cost > costMax) return false;

    // 攻撃力
    if (!isNaN(atkMin) && c.atk < atkMin) return false;
    if (!isNaN(atkMax) && c.atk > atkMax) return false;

    // 意思力
    if (!isNaN(willMin) && c.will < willMin) return false;
    if (!isNaN(willMax) && c.will > willMax) return false;

    // ロア
    if (lore && c.lore != lore) return false;

    // 色
    if (color && c.color !== color) return false;

    // レアリティ
    if (rarity && c.rarity !== rarity) return false;

    // セット
    if (set && c.set != set) return false;

    // 種族（複数指定OK）
    if (races.length && !races.some(r => c.race.includes(r))) return false;

    return true;
  });

  render(result);
}

function render(list){
  const el=document.getElementById("list");
  el.innerHTML="";
  list.forEach(c=>{
    const d=document.createElement("div");
    d.className="card";
    d.innerHTML=`
      <div class="card-image"><img src="${c.image}"></div>
      <div class="card-name">${c.name}</div>`;
    d.onclick=()=>openModal(c);
    el.appendChild(d);
  });
}

function openModal(c){
  modal.style.display="flex";
  modalImg.src=c.image;
  modalText.textContent=c.text;
}
function closeModal(){ modal.style.display="none"; }

render(cards);
</script>

</body>
</html>

